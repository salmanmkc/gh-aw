---
title: Authentication
description: Comprehensive reference for GitHub Actions secrets, GitHub tokens and GitHub Apps in gh-aw
sidebar:
  order: 650
disable-agentic-editing: true
---

import Video from '../../../components/Video.astro';

This page describes authentication settings for GitHub Agentic Workflows.

## Authenticating Your Coding Agent (AI Engine)

You will need one of the following GitHub Actions secrets configured in your repository to authenticate the AI engine you choose:

- **Copilot** – Add [`COPILOT_GITHUB_TOKEN`](#copilot_github_token)
- **Claude by Anthropic** – Add [`ANTHROPIC_API_KEY`](#anthropic_api_key)
- **Codex by OpenAI** – Add [`OPENAI_API_KEY`](#openai_api_key)
- **Gemini by Google** – Add [`GEMINI_API_KEY`](#gemini_api_key)

Most workflows will run without any additional secrets or additional authentication.

## Additional Authentication

Some workflows need additional authentication. These can be tokens added as secrets and referenced in your workflow, or GitHub App can be used.

Workflows using the following **read** operations from GitHub require [Additional Authentication for GitHub Tools](/gh-aw/reference/github-tools/#additional-authentication-for-github-tools), via either a secret containing a PAT or GitHub App:
- **Read from multiple repositories**
- **Read from projects**
- **GitHub tools remote mode**
- **GitHub tools lockdown mode**

Workflows using the following features of [Safe Outputs](/gh-aw/reference/safe-outputs/) require additional authentication, via either a secret containing a PAT or GitHub App:
- [**Safe outputs writing cross-repo**](/gh-aw/reference/safe-outputs/#cross-repository-operations)
- [**Safe outputs assigning Copilot coding agent to issues/PRs**](/gh-aw/reference/assign-to-copilot/)
- [**Safe outputs updating GitHub Projects**](/gh-aw/reference/auth-projects/)
- [**Safe outputs triggering CI on PRs**](/gh-aw/reference/triggering-ci/)

Workflows using custom MCP tools or safe outputs may require additional authentication depending on the operations performed.

## How do I add a GitHub Actions secret to my repository?

You can add secrets manually in the GitHub UI or use the CLI for a streamlined experience.

### Adding secrets using the CLI

```bash
gh aw secrets set COPILOT_GITHUB_TOKEN --value "YOUR_COPILOT_PAT"
```

You can also check existing secrets with:

```bash
gh aw secrets bootstrap
```

If you're working in Codespaces, use the GitHub UI method below to add secrets.

### Adding secrets using the GitHub UI

1. Go to your repository on GitHub
2. Click on "Settings" → "Secrets and variables" → "Actions"
3. Click "New repository secret" and add the token name and value

<picture>
  <source media="(prefers-color-scheme: dark)" srcSet="/gh-aw/images/actions-secrets_dark.png" />
  <img alt="Repository secrets page showing configured tokens" src="/gh-aw/images/actions-secrets_light.png" />
</picture>

## GitHub Actions secrets for AI engines

A reference for all GitHub Actions secrets used by GitHub Agentic Workflows for AI engine authentication:

### `COPILOT_GITHUB_TOKEN`

If using Copilot as your AI engine, you need a GitHub Actions Secret set to a GitHub Personal Access Token (PAT) to authenticate Copilot CLI.

**Setup**:

[**Create a fine-grained PAT**](https://github.com/settings/personal-access-tokens/new?name=COPILOT_GITHUB_TOKEN&description=GitHub+Agentic+Workflows+-+Copilot+engine+authentication&user_copilot_requests=read) (this link pre-fills the token name, description, and Copilot Requests permission). Verify the following settings before generating:

1. **Resource owner** is your **user account**, not an organization.
2. **Repository access** is set to **Public repositories**, even if you will be using it with private repositories. This is required for the "Copilot Requests" permission to be available.
3. Under **Permissions → Account permissions**, **Copilot Requests** is set to **Read**.
4. Click **Generate token** and copy the token value.
5. Add the PAT to your GitHub Actions repository secrets as `COPILOT_GITHUB_TOKEN`, either by CLI or GitHub UI.

   ```bash wrap
   gh aw secrets set COPILOT_GITHUB_TOKEN --value "<your-github-pat>"
   ```

<Video
  src="/gh-aw/videos/create-pat-user-copilot.mp4"
  caption="Creating a fine-grained PAT for user-owned repositories with Copilot permissions"
  aspectRatio="16:9"
  silenced={true}
/>

**Troubleshooting**:

If your workflow fails at the Copilot inference step even with the token set, verify that the token owner's account has an active Copilot license. See [Copilot License or Inference Access Issues](/gh-aw/troubleshooting/common-issues/#copilot-license-or-inference-access-issues) for a local diagnostic step.

---

### `ANTHROPIC_API_KEY`

If using the Claude by Anthropic engine, you need to set a GitHub Actions secret `ANTHROPIC_API_KEY` to be an API key from Anthropic.

**Setup**:

1. Create an API key at https://platform.claude.com/docs/en/get-started

2. Add it to your repository secrets, either by CLI or GitHub UI:

   ```bash wrap
   gh aw secrets set ANTHROPIC_API_KEY --value "YOUR_ANTHROPIC_API_KEY"
   ```

See also [Using Claude Code](/gh-aw/reference/engines/#using-claude-by-anthropic-claude-code) for additional configuration needed when using Claude with GitHub MCP.

---

### `OPENAI_API_KEY`

If using the Codex by OpenAI engine, you need to set a GitHub Actions secret `OPENAI_API_KEY` with an API key from OpenAI.

**Setup**:

1. Create an API key at https://platform.openai.com/api-keys

2. Add it to your repository secrets, either by CLI or GitHub UI:

   ```bash wrap
   gh aw secrets set OPENAI_API_KEY --value "YOUR_OPENAI_API_KEY"
   ```

See also [Using Codex](/gh-aw/reference/engines/#using-openai-codex) for additional configuration needed when using Codex with GitHub MCP.

---

### `GEMINI_API_KEY`

If using the Gemini by Google engine, you need to set a GitHub Actions secret `GEMINI_API_KEY` with an API key from Google AI Studio.

**Setup**:

1. Create an API key at https://aistudio.google.com/api-keys

2. Add it to your repository secrets, either by CLI or GitHub UI:

   ```bash wrap
   gh aw secrets set GEMINI_API_KEY --value "YOUR_GEMINI_API_KEY"
   ```

See also [Using Gemini](/gh-aw/reference/engines/#using-google-gemini-cli) for additional configuration needed when using Gemini with GitHub MCP.

---

## Using a GitHub App for Authentication

For enhanced security with short-lived tokens, you may configure a GitHub App instead of using PATs.

This does not apply to `COPILOT_GITHUB_TOKEN`, which must currently be a PAT. A single GitHub App can be used for all other GitHub authentication needs in GitHub Agentic Workflows, including tool authentication and safe outputs.

After creating your app, configure it in your workflow:

```yaml wrap
permissions:
  contents: read
  issues: read

tools:
  github:
    mode: remote
    toolsets: [repos, issues, pull_requests]
    app:
      app-id: ${{ vars.APP_ID }}
      private-key: ${{ secrets.APP_PRIVATE_KEY }}
      owner: "my-org"                    # Optional: defaults to current repo owner
      repositories: ["repo1", "repo2"]   # Optional: defaults to current repo only
```

Make sure you set up repository variables and secrets:

```bash wrap
gh variable set APP_ID --body "123456"
gh aw secrets set APP_PRIVATE_KEY --value "$(cat path/to/private-key.pem)"
```

At workflow start, a token is automatically minted with **permissions matching your job's `permissions:` field**. The token is passed to the GitHub MCP server and automatically revoked at workflow end (even on failure).

You can also use GitHub App tokens for safe outputs operations:

```yaml wrap
safe-outputs:
  app:
    app-id: ${{ vars.APP_ID }}
    private-key: ${{ secrets.APP_PRIVATE_KEY }}
    owner: "my-org"                    # optional: installation owner
    repositories: ["repo1", "repo2"]   # optional: scope to specific repos
  create-issue:
```

When you configure `app:` for safe outputs, tokens are minted with permissions specific to the safe output operations being performed, rather than the broader job-level permissions. This provides enhanced security by ensuring that tokens have the minimum necessary permissions for their specific use case.

For both tool authentication and safe outputs, you can scope the GitHub App token to specific repositories for enhanced security. This limits the token's access to only the repositories it needs to interact with.

- Omit `repositories` field - Current repository only (default)
- `repositories: ["*"]` - Org-wide access (all repos in the installation)
- `repositories: ["repo1", "repo2"]` - Specific repositories only

---

## Related Documentation

- [Engines](/gh-aw/reference/engines/) - Engine-specific authentication
- [Safe Outputs](/gh-aw/reference/safe-outputs/) - Safe output token configuration
- [Tools](/gh-aw/reference/tools/) - Tool authentication and modes
- [Permissions](/gh-aw/reference/permissions/) - Permission model overview
